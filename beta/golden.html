<!DOCTYPE html><!--  Last Published: Thu Mar 28 2024 08:48:21 GMT+0000 (Coordinated Universal Time)  -->
<html data-wf-page="65fe209c6f3d12acedbc80d5" data-wf-site="651a1e741b97af0938ef7dd5" lang="en">
<head>
  <meta charset="utf-8">
  <title>PawPal | Your Cheerful Golden Retriever Buddy</title>
  <meta content="Immerse yourself in positivity with your Golden Retriever on PawPal, where cheerful interactions brighten your day. Connect and share joy with your sunny virtual friend!" name="description">
  <meta content="PawPal | Your Cheerful Golden Retriever Buddy" property="og:title">
  <meta content="Immerse yourself in positivity with your Golden Retriever on PawPal, where cheerful interactions brighten your day. Connect and share joy with your sunny virtual friend!" property="og:description">
  <meta content="PawPal | Your Cheerful Golden Retriever Buddy" property="twitter:title">
  <meta content="Immerse yourself in positivity with your Golden Retriever on PawPal, where cheerful interactions brighten your day. Connect and share joy with your sunny virtual friend!" property="twitter:description">
  <meta property="og:type" content="website">
  <meta content="summary_large_image" name="twitter:card">
  <meta content="width=device-width, initial-scale=1" name="viewport">
  <link href="../css/normalize.css" rel="stylesheet" type="text/css">
  <link href="../css/webflow.css" rel="stylesheet" type="text/css">
  <link href="../css/one-time-test-link-do-not-share.webflow.css" rel="stylesheet" type="text/css">
  <link href="https://fonts.googleapis.com" rel="preconnect">
  <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin="anonymous">
  <script src="https://ajax.googleapis.com/ajax/libs/webfont/1.6.26/webfont.js" type="text/javascript"></script>
  <script type="text/javascript">WebFont.load({  google: {    families: ["Montserrat:100,100italic,200,200italic,300,300italic,400,400italic,500,500italic,600,600italic,700,700italic,800,800italic,900,900italic","DM Sans:regular,500,700"]  }});</script>
  <script type="text/javascript">!function(o,c){var n=c.documentElement,t=" w-mod-";n.className+=t+"js",("ontouchstart"in o||o.DocumentTouch&&c instanceof DocumentTouch)&&(n.className+=t+"touch")}(window,document);</script>
  <link href="../images/favicon.png" rel="shortcut icon" type="image/x-icon">
  <link href="../images/webclip.png" rel="apple-touch-icon"><!--  Google Tag Manager  -->
  <!-- <script>
(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-WXXHB6BT');
</script>  -->
  <script>
(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl+'&anonymizeIp=true';f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-WXXHB6BT');
</script>
  <!--  End Google Tag Manager  -->
  <!--  google api library for google login  -->
  <script src="https://apis.google.com/js/platform.js" async="" defer=""></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/typed.js/2.0.8/typed.min.js"></script>
</head>
<body class="breed-body">
  <div data-animation="default" data-collapse="medium" data-duration="400" data-easing="ease" data-easing2="ease" role="banner" class="header-wrapper moblie chat left w-nav">
    <div class="header-content-wrapper left">
      <a href="../index.html" class="link-block left w-inline-block"><img src="../images/PAWPAL-HOME-LOGO-V3-UPDATED.png" width="Auto" height="Auto" alt="" class="image header mob left"></a>
      <div class="div-block-11">
        <div class="div-block-13">
          <div data-hover="true" data-delay="5" class="dropdown w-dropdown">
            <div class="dropdown-toggle-2 w-dropdown-toggle">
              <div class="icon w-icon-dropdown-toggle"></div>
              <div class="text-block-15">MENU</div>
            </div>
            <nav class="dropdown-list-4 w-dropdown-list">
              <a href="../beta/pick-your-pal.html" target="_blank" class="w-dropdown-link">Pick Your Pal</a>
              <a href="../beta/tell-a-friend.html" target="_blank" class="dropdown-link-9 w-dropdown-link">Invite Friend</a>
              <a href="../sign-up.html" target="_blank" class="invite-friend signin w-button">SIGN UP/LOGIN</a>
              <a id="randomButton" href="#" class="invite-friend signin green random w-button">RANDOMIZER</a>
              <a href="#" class="invite-friend signin signout w-button">Sign Out</a>
              <a id="randomButton" href="#" class="invite-friend signin feed w-button">FEEDBACK</a>
              <a id="shareinvite" href="#" class="invite-friend w-button">Invite Friend</a>
            </nav>
          </div>
          <a href="#" class="button-11 w-button"></a>
          <div class="div-block-26 mob"><img src="../images/DARK-MODE-ICONs-02.png" loading="lazy" id="DARK-MODE" alt="" class="image-41 icon"></div>
        </div>
      </div>
    </div>
  </div>
  <div class="background"></div>
  <div class="div-block-35">
    <div class="div-block-38">
      <div id="image-container" class="div-block-14"><img src="../images/Bernedoodle.png" loading="eager" sizes="(max-width: 479px) 100vw, (max-width: 767px) 24vw, (max-width: 991px) 50vw, (max-width: 1919px) 49vw, 50vw" srcset="../images/Bernedoodle-p-500.png 500w, ../images/Bernedoodle-p-800.png 800w, ../images/Bernedoodle.png 1024w" alt="" class="image-17 breed"></div>
      <div class="div-block-9">
        <section class="chat-section desktop beta">
          <div class="w-layout-blockcontainer chat-container w-container"></div>
        </section>
        <div class="text-block-11"></div>
      </div>
      <div id="image-container" class="div-block-14 mob"><img src="../images/0_1-1-1.png" loading="lazy" sizes="100vw" srcset="../images/0_1-1-1-p-500.png 500w, ../images/0_1-1-1-p-800.png 800w, ../images/0_1-1-1.png 1024w" alt="" class="image-17 breed"></div>
    </div>
  </div>
  <div class="v2-chat-section">
    <div class="breed-block">
      <section class="chat-section desktop breed beta">
        <div class="w-layout-blockcontainer chat-container breed w-container"></div>
      </section>
      <div class="text-block-11"></div>
    </div>
  </div>
  <div class="breed-block moblie"><img src="../images/Bernedoodle.png" loading="lazy" sizes="(max-width: 479px) 78vw, 100vw" srcset="../images/Bernedoodle-p-500.png 500w, ../images/Bernedoodle-p-800.png 800w, ../images/Bernedoodle.png 1024w" alt="" class="breed"></div>
  <div class="div-block-32">
    <div class="w-layout-blockcontainer chat-input-container breed beta w-container">
      <div class="form-block w-form">
        <form id="email-form" name="email-form" data-name="Email Form" method="get" class="form-2" data-wf-page-id="65fe209c6f3d12acedbc80d5" data-wf-element-id="68a61c73-005a-2514-d9c0-8c609938c6c1">
          <div class="columns-2 w-row">
            <div class="column-4 w-col w-col-10"><input class="userinput w-input" maxlength="256" name="field-2" data-name="Field 2" placeholder="Enter To Respond" type="text" id="field-2" required=""></div>
            <div class="column-5 w-col w-col-1"><img width="36" alt="" src="../images/mic.svg" loading="lazy" class="image-5"></div>
            <div class="column-6 w-col w-col-1">
              <a href="#" class="sendbutton w-button"></a>
              <a href="#" class="button-12 w-button"></a>
            </div>
          </div>
          <div class="text-block-14">Speeds may vary. Your PawPal is in training and may make mistakes. Verify crucial information. <br></div>
          <div class="text-block-14"><strong class="bold-text-9">Â© 2024 PawPal LLC. All Rights Reserved.</strong><br></div>
        </form>
        <div class="w-form-done">
          <div>Thank you! Your submission has been received!</div>
        </div>
        <div class="w-form-fail">
          <div>Oops! Something went wrong while submitting the form.</div>
        </div>
      </div>
    </div>
  </div>
  <script src="https://d3e54v103j8qbb.cloudfront.net/js/jquery-3.5.1.min.dc5e7f18c8.js?site=651a1e741b97af0938ef7dd5" type="text/javascript" integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script>
  <script src="../js/webflow.js" type="text/javascript"></script><!--  Google Tag Manager (noscript)  -->
  <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-WXXHB6BT" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
  <!--  End Google Tag Manager (noscript)  -->
  <script>
function shareContent() {
  // The URL and text you want to share
  var shareData = {
    title: 'Welcome to PawPal!',
    text: "Give PawPal a try! It's an app with a virtual dog designed for engaging conversation and support. Sounds like something you'd like!",
    url: 'https://www.pawpal.ai/' // Replace with the URL you want to share
  };
  // Check if the Web Share API is supported
  if (navigator.share) {
    // Use the Web Share API
    navigator.share(shareData)
      .then(() => console.log('Successful share'))
      .catch((error) => console.log('Error sharing:', error));
  } else {
    // Fallback to SMS if Web Share API is not supported
    shareViaSMS(shareData.url);
  }
}
function shareViaSMS(url) {
  // Encode the URL to ensure it's safe to include in the SMS body
  var encodedURL = encodeURIComponent(url);
  // Create the SMS link
  var smsLink = 'sms:?&body=' + shareData.text + encodedURL;
  // Redirect to the SMS link
  window.location.href = smsLink;
}
// Wait for the DOM to be fully loaded
document.addEventListener('DOMContentLoaded', function() {
  // Attach the shareContent function to the button's click event
  var shareButton = document.getElementById('shareinvite');
  if (shareButton) {
    shareButton.addEventListener('click', shareContent);
  }
});
const getColorSchemeBtn = document.getElementById("DARK-MODE");
if (getColorSchemeBtn)
  getColorSchemeBtn.addEventListener("click", colorScheme);
      function colorScheme() {
        function setTheme(theme) {
          const style = document.createElement("style");
          style.textContent = `
html {
background:red;
}
body {
font-family: Arial, sans-serif;
}
.dark-mode {
background-color: black;
color: #fff;
}
.light-mode {
background-color: #fff;
}
.blue-mode {
  background-image: linear-gradient(#2663c0, #031025);
color: #fff;
}
.blue-mode *[style*="background-color: rgb(255, 255, 255)"],
.blue-mode *[style*="background-color: #ffffff"],
.blue-mode *[style*="background-color: #fff"] {
color: #000 !important;
}
.dark-mode *[style*="background-color: rgb(255, 255, 255)"],
.dark-mode *[style*="background-color: #ffffff"],
.dark-mode *[style*="background-color: #fff"] {
color: black !important;
}
.light-mode *[style*="background-color: #010a97"] {
color: #fff !important;
}
`;
          document.head.appendChild(style);
          document.body.className = theme;
          localStorage.setItem("theme", theme);
        }
        const colorModeIcon = document.querySelector(".div-block-26.mob img");
        const headerLogo = document.querySelector(
          ".header-content-wrapper.left img"
        );
        function toggleMode() {
          const currentTheme = localStorage.getItem("theme");
          let newTheme;
          const footerTextHtml = document.querySelectorAll(".text-block-14");
          const rightsText = document.querySelector(".bold-text-9");
          if (currentTheme === "dark-mode") {
            newTheme = "light-mode";
            footerTextHtml.forEach((div) => {
              div.style.color = "#000";
            });
            rightsText.style.color = "#000";
            colorModeIcon.src =
              "https://uploads-ssl.webflow.com/651a1e741b97af0938ef7dd5/65e7001608aed95b983e3d74_ICON%20DARK%20MODE-03.png";
            headerLogo.src =
              "https://uploads-ssl.webflow.com/651a1e741b97af0938ef7dd5/65ef4ab5f0b06cf3d3821c57_PAWPAL%20HOME%20LOGO%20BLACK.png";
          } else if (currentTheme === "light-mode") {
            newTheme = "blue-mode";
            footerTextHtml.forEach((div) => {
              div.style.color = "#fff";
            });
            rightsText.style.color = "#fff";
            headerLogo.src =
              "https://uploads-ssl.webflow.com/651a1e741b97af0938ef7dd5/652da206fefe0f232866b8eb_PAWPAL%20HOME%20LOGO%20V3%20UPDATED.png";
            colorModeIcon.src =
              "https://uploads-ssl.webflow.com/651a1e741b97af0938ef7dd5/65e70016a8404f01cd1d7348_ICON%20DARK%20MODE-05.png";
          } else {
            newTheme = "dark-mode";
            footerTextHtml.forEach((div) => {
              div.style.color = "#fff";
            });
            rightsText.style.color = "#fff";
            headerLogo.src =
              "https://uploads-ssl.webflow.com/651a1e741b97af0938ef7dd5/652da206fefe0f232866b8eb_PAWPAL%20HOME%20LOGO%20V3%20UPDATED.png";
            colorModeIcon.src =
              "https://uploads-ssl.webflow.com/651a1e741b97af0938ef7dd5/65e79229c464e53e6390e6a9_DARK%20MODE%20ICONs-02.png";
          }
          setTheme(newTheme);
        }
        const savedTheme = localStorage.getItem("theme");
        if (!savedTheme) {
          setTheme("dark-mode");
        } else {
          setTheme(savedTheme);
        }
        toggleMode();
      }
// start region for sign in, sign out,profile icon
     function clearCookies() {
    var cookies = document.cookie.split(";");
    for (var i = 0; i < cookies.length; i++) {
        var cookie = cookies[i];
        var eqPos = cookie.indexOf("=");
        var name = eqPos > -1 ? cookie.substr(0, eqPos) : cookie;
        document.cookie = name + "=;expires=Thu, 01 Jan 1970 00:00:00 GMT;path=/";
    }
       window.location.href = "/beta/intro-page";
}
  function getCookie(name) {
        const cookieValue = document.cookie.match(
          "(^|;)\\s*" + name + "\\s*=\\s*([^;]+)"
        );
        return cookieValue ? cookieValue.pop() : "";
      }
(function () {
    const signInBtn = document.querySelector(
      ".invite-friend.signin.w-button"
    );
    const signOut = document.querySelector(
      ".invite-friend.signin.signout.w-button"
    );
    const profileIcon = document.querySelector(".button-11.w-button");
    var firstUserId = getCookie("userId");
    if (firstUserId) {
      profileIcon.style.display = "block";
      signOut.style.display = "block";
      signInBtn.style.display = "none";
    } else {
      profileIcon.style.display = "none";
      signOut.style.display = "none";
      signInBtn.style.cssText = "display:block;";
    }
    signOut.addEventListener("click", () => {
      clearCookies();
    });
  })();
   window.onload=function(){
     document.querySelector('.header-wrapper.moblie.chat').style.marginTop="0px"
 const getClass=document.querySelector(".w-mod-js.w-mod-touch.wf-montserrat-n1-active.wf-montserrat-i1-active.wf-montserrat-n2-active.wf-montserrat-i2-active.wf-montserrat-n3-active.wf-montserrat-i3-active.wf-montserrat-n4-active.wf-montserrat-i4-active.wf-montserrat-n5-active.wf-montserrat-i5-active.wf-montserrat-n6-active.wf-montserrat-i6-active.wf-montserrat-n7-active.wf-montserrat-i7-active.wf-montserrat-n8-active.wf-montserrat-i8-active.wf-montserrat-n9-active.wf-montserrat-i9-active.wf-dmsans-n4-active.wf-dmsans-n5-active.wf-dmsans-n7-active.wf-active.w-mod-ix")
      if(getClass)  getClass.style.cssText =
          "background-image: linear-gradient(#2663c0, #031025) !important;";
      }
  // region end
  // start region for randomizer button
      var linksArray = [
        "/demo-v-2-breeds/bernedoodle-demo-v-2",
        "/demo-v-2-breeds/english-springer-spaniel-demo-v-2",
        "/demo-v-2-breeds/dalmatian-demo-v-2",
        "/demo-v-2-breeds/german-shepherd-demo-v-2",
        "/demo-v-2-breeds/golden-retriever-demo-v-3",
        "/demo-v-2-breeds/rottweiler-demo-v-2",
      ];
      // Function to pick a random link
      function pickRandomLink() {
        var randomIndex = Math.floor(Math.random() * linksArray.length);
        var randomLink = linksArray[randomIndex];
        window.location.href = randomLink; // Redirects to the random link
      }
     document.addEventListener("DOMContentLoaded", function () {
        var randomButton = document.getElementById("randomButton"); // Make sure to assign the correct ID to your button
        if (randomButton) {
          randomButton.addEventListener("click", pickRandomLink);
        }
      });
  // end region 
</script>
<script>

  // Speech recognition
  const recordBtn = document.querySelector('.button-12.w-button');
  let SpeechRecognition =
    window.SpeechRecognition || window.webkitSpeechRecognition,
  recognition,
  recording = false;

  recordBtn.addEventListener("click", () => {
    console.log("listening")
  if (!recording) {
    speechToText();
    recording = true;
  } else {
    stopRecording();
  }
});

function stopRecording() {
  recognition.stop();
  // recordBtn.querySelector("p").innerHTML = "Start Listening";
  // recordBtn.classList.remove("recording");
  recording = false;
}

  function speechToText() {
  try {
    recognition = new SpeechRecognition();
    recognition.lang = "en";
    recognition.interimResults = true;
    recordBtn.classList.add("recording");
    // recordBtn.querySelector("p").innerHTML = "Listening...";
    recognition.start();
    recognition.onresult = (event) => {
      const speechResult = event.results[0][0].transcript;
      alert(speechResult+" :speechResult")
      // //detect when intrim results
      // if (event.results[0].isFinal) {
      //   // result.innerHTML += " " + speechResult;
      //   result.querySelector("p").remove();
      // } else {
      //   //creative p with class interim if not already there
      //   if (!document.querySelector(".interim")) {
      //     const interim = document.createElement("p");
      //     interim.classList.add("interim");
      //     result.appendChild(interim);
      //   }
      //   //update the interim p with the speech result
      //   document.querySelector(".interim").innerHTML = " " + speechResult;
      // }
      // downloadBtn.disabled = false;
    };
    recognition.onspeechend = () => {
      speechToText();
    };
    recognition.onerror = (event) => {
      stopRecording();
      if (event.error === "no-speech") {
        alert("No speech was detected. Stopping...");
      } else if (event.error === "audio-capture") {
        alert(
          "No microphone was found. Ensure that a microphone is installed."
        );
      } else if (event.error === "not-allowed") {
        alert("Permission to use microphone is blocked.");
      } else if (event.error === "aborted") {
        alert("Listening Stopped.");
      } else {
        alert("Error occurred in recognition: " + event.error);
      }
    };
  } catch (error) {
    recording = false;

    console.log(error);
  }
}

        // List of links to choose from
        var linksArray = [
        "/beta/bernedoodle",
       "/beta/shepherd",
      ];

      // Function to pick a random link
      function pickRandomLink() {
        var randomIndex = Math.floor(Math.random() * linksArray.length);
        var randomLink = linksArray[randomIndex];
        window.location.href = randomLink; // Redirects to the random link
      }

      // Add event listener to the button
      document.addEventListener("DOMContentLoaded", function () {
        var randomButton = document.getElementById("randomButton"); // Make sure to assign the correct ID to your button
        if (randomButton) {
          randomButton.addEventListener("click", pickRandomLink);
        }
      });

      // extract link from bot result
      function extractImageLink(message, timestamp, callback) {
        if (typeof message !== "string" || message.trim() === "") {
          return;
        }

        // extract string
        let index = message.indexOf(")");
        let resultText;
        if (index !== -1) {
          resultText = message.substring(index + 1);
        }

        const regex = /\((.*?)\)/;
        const match = message.match(regex);
        if (match && match.length > 1) {
          const imageLink = match[1];
          createCanvasImage(imageLink, timestamp, resultText);
          if (callback) callback(true);
        } else {
          if (callback) callback(false);
        }
      }

      // create canvas for image
      function createCanvasImage(imageLink, timestamp, resultText) {
        const chatContainer = document.querySelector(".chat-container");
        const chatBubble = document.createElement("div");
        chatBubble.classList.add("chat-bubble1", "bot"); // Create canvas element
        const canvas = document.createElement("canvas");
        canvas.width = 300;
        canvas.height = 300;
        canvas.style.borderRadius = "15px";
        // Show loading indicator
        const loadingIndicator = document.createElement("div");
        loadingIndicator.style.cssText =
          "width:300px; height:300px;display:flex;justify-content:center; align-items:center;";
        loadingIndicator.textContent = "Loading";
        const image = document.createElement("img");
        image.style.width = "35px";
        image.src =
          "https://uploads-ssl.webflow.com/651a1e741b97af0938ef7dd5/65caaf100d2e9c6e6c2df009_bubble.svg";
        loadingIndicator.appendChild(image);
        chatBubble.appendChild(loadingIndicator);
        const textSpan = document.createElement("span");
        textSpan.textContent = resultText;
        const ctx = canvas.getContext("2d");
        const img = new Image();
        img.src = imageLink;
        scrollToLatestMessage();

        img.onload = function () {
          loadingIndicator.remove();

          chatBubble.appendChild(canvas);
          chatBubble.appendChild(textSpan);
          chatBubble.appendChild(timestamp);
          ctx.clearRect(0, 0, canvas.width, canvas.height);
          ctx.drawImage(img, 0, 0, canvas.width, canvas.height);
          scrollToLatestMessage();
        };
        chatContainer.appendChild(chatBubble);
        return;
      }
      function checkMessage(message) {
        const keywords = ["What", "When", "How", "Tell", "look up", "search"];
        const keywordsSeekingAttention = [
          "Look",
          "attention",
          "hear",
          "said",
          "important",
          "Listen",
          "share",
          "something",
          "happened",
          "talk",
          "need",
          "feeling",
          "reminds",
          "boring",
          "notice",
          "saying",
          "enough",
          "acknowledge",
          "left out",
          "validation",
        ];
        const keywordsHeardSomething = [
          "ask",
          "question",
          "heard",
          "overheard",
          "listened",
          "heard about",
        ];
        const shinyStars = ["Intelligent", "Awesome", "Good", "Smart"];
        const image = document.querySelector("#image-container img");
        const imageMob = document.querySelector(".div-block-14.mob img");
        const lowerCaseInput = message.toLowerCase();
        for (const keyword of keywords) {
          if (lowerCaseInput.includes(keyword.toLowerCase())) {
            const src = image.getAttribute("src");
            if (
              src !==
              "https://uploads-ssl.webflow.com/651a1e741b97af0938ef7dd5/65df6f864934f182c1231128_Dog%20Glasses.gif"
            ) {
              image.srcset =
                "https://uploads-ssl.webflow.com/651a1e741b97af0938ef7dd5/65df6f864934f182c1231128_Dog%20Glasses.gif";
              image.src =
                "https://uploads-ssl.webflow.com/651a1e741b97af0938ef7dd5/65df6f864934f182c1231128_Dog%20Glasses.gif";
              imageMob.srcset =
                "https://uploads-ssl.webflow.com/651a1e741b97af0938ef7dd5/65df6f864934f182c1231128_Dog%20Glasses.gif";
              imageMob.src =
                "https://uploads-ssl.webflow.com/651a1e741b97af0938ef7dd5/65df6f864934f182c1231128_Dog%20Glasses.gif";
            }
            return true;
          }
        }
        for (const keyword of keywordsSeekingAttention) {
          if (lowerCaseInput.includes(keyword.toLowerCase())) {
            const src = image.getAttribute("src");
            if (
              src !==
              "https://uploads-ssl.webflow.com/651a1e741b97af0938ef7dd5/65df6f86957b2778aa70c183_seekingattention.gif"
            ) {
              image.srcset =
                "https://uploads-ssl.webflow.com/651a1e741b97af0938ef7dd5/65df6f86957b2778aa70c183_seekingattention.gif";
              image.src =
                "https://uploads-ssl.webflow.com/651a1e741b97af0938ef7dd5/65df6f86957b2778aa70c183_seekingattention.gif";
              imageMob.srcset =
                "https://uploads-ssl.webflow.com/651a1e741b97af0938ef7dd5/65df6f86957b2778aa70c183_seekingattention.gif";
              imageMob.src =
                "https://uploads-ssl.webflow.com/651a1e741b97af0938ef7dd5/65df6f86957b2778aa70c183_seekingattention.gif";
            }
            return true;
          }
        }

        for (const keyword of keywordsHeardSomething) {
          if (lowerCaseInput.includes(keyword.toLowerCase())) {
            const src = image.getAttribute("src");
            if (
              src !==
              "https://uploads-ssl.webflow.com/651a1e741b97af0938ef7dd5/65df6f87bee691b1944db531_heardSomething.gif"
            ) {
              image.srcset =
                "https://uploads-ssl.webflow.com/651a1e741b97af0938ef7dd5/65df6f87bee691b1944db531_heardSomething.gif";
              image.src =
                "https://uploads-ssl.webflow.com/651a1e741b97af0938ef7dd5/65df6f87bee691b1944db531_heardSomething.gif";
              imageMob.srcset =
                "https://uploads-ssl.webflow.com/651a1e741b97af0938ef7dd5/65df6f87bee691b1944db531_heardSomething.gif";
              imageMob.src =
                "https://uploads-ssl.webflow.com/651a1e741b97af0938ef7dd5/65df6f87bee691b1944db531_heardSomething.gif";
            }
            return true;
          }
        }
        for (const keyword of shinyStars) {
          if (lowerCaseInput.includes(keyword.toLowerCase())) {
            const src = image.getAttribute("src");
            if (
              src !==
              "https://uploads-ssl.webflow.com/651a1e741b97af0938ef7dd5/65df6f86e843a6835fe3bf46_Shining.gif"
            ) {
              image.srcset =
                "https://uploads-ssl.webflow.com/651a1e741b97af0938ef7dd5/65df6f86e843a6835fe3bf46_Shining.gif";
              image.src =
                "https://uploads-ssl.webflow.com/651a1e741b97af0938ef7dd5/65df6f86e843a6835fe3bf46_Shining.gif";
              imageMob.srcset =
                "https://uploads-ssl.webflow.com/651a1e741b97af0938ef7dd5/65df6f86e843a6835fe3bf46_Shining.gif";
              imageMob.src =
                "https://uploads-ssl.webflow.com/651a1e741b97af0938ef7dd5/65df6f86e843a6835fe3bf46_Shining.gif";
            }
            return true;
          }
        }

        if (!message) {
          image.srcset =
            "https://uploads-ssl.webflow.com/651a1e741b97af0938ef7dd5/65df6f87bee691b1944db531_heardSomething.gif";
          image.src =
            "https://uploads-ssl.webflow.com/651a1e741b97af0938ef7dd5/65df6f87bee691b1944db531_heardSomething.gif";
          imageMob.srcset =
            "https://uploads-ssl.webflow.com/651a1e741b97af0938ef7dd5/65df6f87bee691b1944db531_heardSomething.gif";
          imageMob.src =
            "https://uploads-ssl.webflow.com/651a1e741b97af0938ef7dd5/65df6f87bee691b1944db531_heardSomething.gif";
        }

        return false;
      }

      // store conversation
      function insertMsg(data) {
        const myHeaders = new Headers();
        myHeaders.append("Content-Type", "application/json");
        const requestOptions = {
          method: "POST",
          headers: myHeaders,
          body: data,
          redirect: "follow",
        };

        fetch("https://api.pawpal.ai/api/v1/chat", requestOptions)
          .then((response) => response.text())
          .then((result) => {
            return;
          })
          .catch((error) => {
            throw error;
          });
      }
      // get login details
      function getCookie(name) {
        const cookieValue = document.cookie.match(
          "(^|;)\\s*" + name + "\\s*=\\s*([^;]+)"
        );
        return cookieValue ? cookieValue.pop() : "";
      }

      // get breed id
      function breedId() {
        const url = window.location.href;
        const parts = url.split("/");
        const breed = parts[parts.length - 1].split(".")[0];
        return breed;
      }

      var firstUserId = getCookie("userId");
      var secondUserId = breedId();

      // get chat conversation
      function msg(sender, message, timestamp) {
        // Get all chat-bubble1 elements
        const chatBubbles = document.querySelectorAll(".chat-bubble1");

        // Initialize variables to store the last text and time for both user and bot
        let lastUserText = null;
        let lastUserTime = null;
        let lastBotText = null;
        let lastBotTime = null;

        // Iterate over each chat bubble
        chatBubbles.forEach((chatBubble) => {
          // Get the text content from the chat bubble
          const textContent = chatBubble?.textContent.trim();

          // Get the timestamp content from the chat bubble
          const timestamp = chatBubble
            .querySelector(".timestamp")
            ?.textContent?.trim();

          // Determine if it's from user or bot
          if (chatBubble?.classList?.contains("user")) {
            // Update last user text and time
            lastUserText = textContent;
            lastUserTime = timestamp;
          } else if (chatBubble?.classList?.contains("bot")) {
            // Update last bot text and time
            lastBotText = textContent;
            lastBotTime = timestamp;
          }
        });

        let conversation = [
          {
            from: firstUserId,
            to: secondUserId,
            time: lastUserTime,
            message: lastUserText,
          },
          {
            from: secondUserId,
            to: firstUserId,
            time: timestamp,
            message: message,
          },
        ];
        // Output the last text and time for both user and bot
        const data = JSON.stringify({
          firstUserId: firstUserId,
          secondUserId: secondUserId,
          date: new Date(),
          chat: [...conversation],
        });

        insertMsg(data);
      }

      // Function to scroll to the bottom of the chat container
      function scrollToLatestMessage(delay = 0) {
        const chatContainer = document.querySelector(".chat-container");
        // Delay scrolling slightly to account for the height change
        setTimeout(() => {
          chatContainer.scrollTop = chatContainer.scrollHeight;
          chatContainer.scrollIntoView({ block: "end" });
        }, delay);
      }

      // Function to generate random ID
      function getRandomId() {
        return Math.random().toString(36).substring(2, 10);
      }

      // Generate on page load
      const userId = getRandomId();

      // Function to post user's message to API
      async function postMessageToAPI(message) {
        // For adding bubble when thinking bot by made ravi
        // started
        const chatContainer = document.querySelector(".chat-container");
        const bubble = document.createElement("div");
        bubble.classList.add("chat-bubble1");
        bubble.classList.add("bot");
        bubble.classList.add("bubble");
        const image = document.createElement("img");
        image.src =
          "https://uploads-ssl.webflow.com/651a1e741b97af0938ef7dd5/65caaf100d2e9c6e6c2df009_bubble.svg";
        image.style.marginBottom = "2px";
        image.style.width = "30px";
        image.style.bottom = "unset";
        image.style.left = "unset";
        chatContainer.style.marginBottom = "5px";
        const imageBreed = document.querySelector("#image-container img");
        imageBreed.srcset =
          "https://uploads-ssl.webflow.com/651a1e741b97af0938ef7dd5/65df6f87fb7b84bf6452c80b_Thinking.gif";
        bubble.appendChild(image);
        chatContainer.appendChild(bubble);
        scrollToLatestMessage();
        // end

        const result = await query(message);
        if (result?.message["out-2"]) {
          // remove bubble when get the result
          bubble.remove();
          imageBreed.srcset =
            "https://uploads-ssl.webflow.com/651a1e741b97af0938ef7dd5/65df6f87bee691b1944db531_heardSomething.gif";
          const { timestamp, timeString } = createTimestamp(); // Create a timestamp for all messages

          extractImageLink(result?.message["out-2"], timestamp, (res) => {
            var firstUserId = getCookie("userId");

            if (!res) {
              displayChatBubble("bot", result?.message["out-2"]);
              scrollToLatestMessage();
            } else if (firstUserId) {
              msg("bot", result?.message["out-2"], timeString);
            }
          });
        }
      }
      async function query(message) {
        const myHeaders = new Headers();
        myHeaders.append("Content-Type", "application/json");

        const raw = JSON.stringify({
          message: message,
        });

        const requestOptions = {
          method: "POST",
          headers: myHeaders,
          body: raw,
          redirect: "follow",
        };

        return await fetch(
          "https://api.pawpal.ai/api/v1/pawpal-ai/v3",
          requestOptions
        )
          .then((response) => response.text())
          .then((result) => {
            return JSON.parse(result);
          });
      }

      // get data from db of user
      function getOldData(callback) {
        const myHeaders = new Headers();
        myHeaders.append("Content-Type", "application/json");

        const raw = JSON.stringify({
          firstUserId: firstUserId,
          secondUserId: secondUserId,
        });

        const requestOptions = {
          method: "POST",
          headers: myHeaders,
          body: raw,
          redirect: "follow",
        };

        fetch("https://api.pawpal.ai/api/v1/chat/list", requestOptions)
          .then((response) => response.text())
          .then((result) => {
            if (callback)
              callback(
                JSON.parse(result).result.length > 0
                  ? JSON.parse(result).result[0].chat
                  : []
              );
          })
          .catch((error) => console.error(error));
      }

      // get speech

      async function getSpeech(text) {
        const myHeaders = new Headers();
        myHeaders.append("Content-Type", "application/json");
        const raw = JSON.stringify({
          text,
          voice: "21m00Tcm4TlvDq8ikWAM",
          voice_settings: {
            stability: 0,
            similarity_boost: 0,
          },
        });

        const requestOptions = {
          method: "POST",
          headers: myHeaders,
          body: raw,
          redirect: "follow",
        };

        return await fetch(
          "https://api.pawpal.ai/api/v1/chat/tts",
          requestOptions
        )
          .then((response) => response.text())
          .then((result) => {
            return result;
          })
          .catch((error) => console.error(error));
      }
      // create html conversation
      async function conversationFromDb(callback) {
        getOldData(async (chatData) => {
          const chatContainer = document.querySelector(".chat-container");
          // Loop through the chat data
          chatData.forEach((chat, i) => {
            if (chat.from === firstUserId && chat.message) {
              const chatBubble = document.createElement("div");
              chatBubble.classList.add("chat-bubble1", "user");
              chatBubble.style.display = "flex";
              (chatBubble.style.flexDirection = "column"),
                (chatBubble.style.gap = "5px");
              const newMsg = chat.message.replace(chat.time, "").trim();
              const textSpan = document.createElement("span");
              textSpan.textContent = newMsg;
              chatBubble.appendChild(textSpan);

              const timestamp = document.createElement("span");
              timestamp.style.display = "flex";
              timestamp.style.justifyContent = "end";
              timestamp.textContent = chat.time;
              chatBubble.appendChild(timestamp);

              chatContainer.appendChild(chatBubble);
            } else if (chat.from === secondUserId && chat.message) {
              const newMsg = chat.message.replace(chat.time, "").trim();

              const timestamp = document.createElement("span");
              timestamp.style.display = "flex";
              timestamp.style.justifyContent = "end";
              timestamp.textContent = chat.time;
              extractImageLink(newMsg, timestamp, async (res) => {
                if (!res) {
                  const chatBubble = document.createElement("div");
                  chatBubble.classList.add("chat-bubble1", "bot");

                  // TTS logic start
                  timestamp.style.cssText = `justify-content: end;gap: 10px;display: flex;align-items: end;`;
                  const audio = document.createElement("audio");
                  const playIcon = document.createElement("img");
                  playIcon.style.cssText = `width:30px; height:30px;margin-bottom: 0;`;
                  playIcon.src = "https://uploads-ssl.webflow.com/651a1e741b97af0938ef7dd5/6604f623c14ee6f1352ecd80_tts%20icons-04.png";
                  playIcon.id = "play_speech" + i;
                  audio.id = "speech";
                  chatBubble.appendChild(audio);
                  var isPlaying = false;
                  playIcon.addEventListener("click", () => {
                    if (isPlaying) {
                      pauseAudio();
                    } else {
                      playAudio();
                    }
                  });
                  function playAudio() {
                    isPlaying = true;
                    audio.play();
                  }

                  function pauseAudio() {
                    isPlaying = false;
                    audio.pause();
                  }

                  audio.addEventListener("ended", function () {
                    isPlaying = false;
                  });

                  // TTS logic end
                  chatBubble.style.display = "flex";
                  (chatBubble.style.flexDirection = "column"),
                    (chatBubble.style.gap = "5px");

                  const textSpan = document.createElement("span");
                  textSpan.textContent = newMsg;

                  chatBubble.appendChild(textSpan);

                  chatBubble.appendChild(timestamp);
                  chatContainer.appendChild(chatBubble);

                  // TTS button logic start
                  const resultTts = await getSpeech(newMsg);
                  if (audio && audio) {
                    timestamp.appendChild(playIcon);

                    audio.setAttribute(
                      "src",
                      JSON.parse(resultTts).audioDataURI
                    );
                  }
                  // TTS button logic end
                }
              });
            }
          });
          await new Promise((resolve) => setTimeout(resolve, 0));

          if (callback) callback(chatData);
        });
      }
      // Function to display chat bubbles with live typing effect

      async function displayChatBubble(sender, message) {
        const chatContainer = document.querySelector(".chat-container");
        const bubble = document.createElement("div");
        bubble.classList.add("chat-bubble1");
        const { timestamp, timeString } = createTimestamp(); // Create a timestamp for all messages

        if (sender === "user") {
          bubble.classList.add("user");
          bubble.innerHTML = message; // Display the message as is
          bubble.appendChild(timestamp); // Append the timestamp for user messages
          chatContainer.appendChild(bubble);
        } else if (sender === "bot") {
          if (firstUserId) {
            msg(sender, message, timeString);
          }
          bubble.classList.add("bot");
          chatContainer.appendChild(bubble);
          // Check if the message contains a link and replace it with an anchor tag
          // started
          const linkPattern = /\[(.*?)\]\s?\((.*?)\)/;
          if (linkPattern.test(message)) {
            const [fullMatch, linkText, linkUrl] = message.match(linkPattern);
            const linkElement = document.createElement("a");
            linkElement.href = linkUrl;
            linkElement.textContent = linkText;
            linkElement.target = "_blank"; // Open link in new tab
            message = message.replace(fullMatch, linkElement.outerHTML);
            liveTypeMessageWithLInk(bubble, message, timestamp);
          } else {
            liveTypeMessage(bubble, message, timestamp); // Pass the timestamp to the typing effect function
          }
          const getAudio = document.getElementsByTagName("audio");
          const resultTts = await getSpeech(message);
          if (getAudio && getAudio[0]) {
            getAudio[0].setAttribute("src", JSON.parse(resultTts).audioDataURI);
            const getPlayBtn = document.getElementById("play_speech");
            if (getPlayBtn) getPlayBtn.style.display = "block";
          }
          // end
        }
        scrollToLatestMessage();
      }

      // when bot return some link in result
      // started
      function liveTypeMessageWithLInk(element, message, timestamp) {
        let i = 0;
        const typingSpeed = 50; // milliseconds

        function typeChar() {
          scrollToLatestMessage();
          if (i < message.length) {
            if (message.charAt(i) === "<") {
              // Check if the current character is part of an HTML tag
              let endIndex = message.indexOf(">", i); // Find the closing bracket of the tag
              if (endIndex !== -1) {
                element.innerHTML += message.substring(i, endIndex + 1);
                i = endIndex + 1; // Move the index to after the closing bracket
              } else {
                // If closing bracket not found, treat it as a regular character
                element.innerHTML += message.charAt(i);
                i++;
              }
            } else {
              element.innerHTML += message.charAt(i);
              i++;
            }
            scrollToLatestMessage();

            setTimeout(typeChar, typingSpeed);
          } else {
            var containers = document.getElementsByClassName("chat-bubble1");
            // Loop through each element
            for (let i = 0; i < containers.length; i++) {
              var text = containers[i].textContent;

              // Regular expression to match URLs
              var urlRegex = /(https?:\/\/[^\s.]+\.[^\s]+)/g;

              // Replace URLs with anchor tags
              var replacedText = text.replace(urlRegex, function (url) {
                // If URL ends with a period, remove it
                if (url.endsWith(".")) {
                  url = url.slice(0, -1);
                }
                return '<a href="' + url + '" target="_blank">' + url + "</a>";
              });

              // Update the HTML of the element with the replaced text
              containers[i].innerHTML = replacedText;
            }
            element.appendChild(timestamp); // Append the timestamp after the message is typed
            scrollToLatestMessage();
          }
        }

        typeChar();
      }
      // ended

      // Function to simulate live typing
      function liveTypeMessage(element, message, timestamp) {
        let i = 0;
        const typingSpeed = 50; // milliseconds

        function typeChar() {
          if (i < message.length) {
            element.textContent += message.charAt(i);
            i++;
            scrollToLatestMessage();
            setTimeout(typeChar, typingSpeed);
          } else {
            scrollToLatestMessage();
            isSendMsg = false;
            // tts logic start
            const audio = document.createElement("audio");
            const playIcon = document.createElement("img");
            playIcon.style.cssText = `width:30px; height:30px;margin-bottom: 0;`;
            playIcon.src = "../images/voice.png";
            playIcon.id = "play_speech" + i;
            audio.id = "speech" + i;
            element.appendChild(audio);
            timestamp.style.cssText = `gap: 10px;display: flex;align-items: end;`;
            timestamp.appendChild(playIcon);

            var isPlaying = false;
            playIcon.addEventListener("click", () => {
              if (isPlaying) {
                // play.textContent = "Play";
                pauseAudio();
              } else {
                // play.textContent = "Pause";
                playAudio();
              }
            });
            function playAudio() {
              isPlaying = true;
              audio.play();
            }

            function pauseAudio() {
              isPlaying = false;
              audio.pause();
            }
            audio.addEventListener("ended", function () {
              isPlaying = false;
            });

            element.appendChild(timestamp); // Append the timestamp after the message is typed

            // tts logic end
          }
        }
        typeChar();
      }

      // Function to create a timestamp span
      function createTimestamp() {
        const timestamp = document.createElement("span");
        const now = new Date();
        const timeString =
          now.getHours().toString().padStart(2, "0") +
          ":" +
          now.getMinutes().toString().padStart(2, "0");
        timestamp.textContent = timeString;
        timestamp.classList.add("timestamp");
        return { timestamp, timeString };
      }

      // Function to clear the user input field
      function clearUserInput() {
        document.querySelector(".userinput").value = "";
      }

      var isSendMsg = false;

      // Event listener for the submit button
      document
        .querySelector(".sendbutton")
        .addEventListener("click", function (e) {
          e.preventDefault();
          if (isSendMsg) return;
          else {
            isSendMsg = true;
            document.activeElement.blur();
            const inputElement = document.querySelector(".sendbutton")?.blur();
            const userMessage = document
              .querySelector(".userinput")
              .value.trim(); // Trim the input
            if (userMessage.length >= 2) {
              // Check if the message has at least 2 characters
              displayChatBubble("user", userMessage);
              postMessageToAPI(userMessage);
              clearUserInput();
              scrollToLatestMessage();
            }
          }
        });

      // Displaying the welcome message when the chat window loads
      window.onload = async function () {
        const signInUpBtn = document.querySelector(
          ".invite-friend.signin.w-button"
        );
        const signInOutBtn = document.querySelector(
          ".invite-friend.signin.signout.w-button"
        );
        var firstUserId = getCookie("userId");
        if (firstUserId) {
          signInUpBtn.style.display = "none";
          signInOutBtn.style.display = "block";
        } else {
          signInOutBtn.style.display = "none";
          signInUpBtn.style.display = "block";
        }

        // logout logic
        function clearAllCookies() {
          return new Promise((resolve, reject) => {
            var cookies = document.cookie.split(";");

            for (var i = 0; i < cookies.length; i++) {
              var cookie = cookies[i];
              var eqPos = cookie.indexOf("=");
              var name = eqPos > -1 ? cookie.substr(0, eqPos).trim() : cookie;
              document.cookie =
                name +
                "=;expires=Thu, 01 Jan 1970 00:00:00 GMT;path=/;domain=" +
                window.location.hostname;
            }

            resolve(); // Resolve the promise once all cookies are cleared
          });
        }

        signInOutBtn.addEventListener("click", () => {
          clearAllCookies().then(() => {
            window.location.href = "/";
          });
        });
        const image = document.querySelector("#image-container img");
        const imageMob = document.querySelector(".div-block-14.mob img");
        image.srcset =
          "https://uploads-ssl.webflow.com/651a1e741b97af0938ef7dd5/65df6f87bee691b1944db531_heardSomething.gif";
        imageMob.srcset =
          "https://uploads-ssl.webflow.com/651a1e741b97af0938ef7dd5/65df6f87bee691b1944db531_heardSomething.gif";

        const inputElement = document.querySelector(".userinput");
        const textAreaElement = document.createElement("textarea");
        // Copy over attributes from the input to the textarea
        textAreaElement.className = inputElement.className;
        textAreaElement.id = inputElement.id;
        textAreaElement.name = inputElement.name;
        textAreaElement.placeholder = inputElement.placeholder;
        textAreaElement.required = inputElement.required;
        textAreaElement.maxLength = 356;

        textAreaElement.style.cssText = `
        overflow: auto;
        white-space: pre-wrap;
        resize: vertical;
        height: 50px;
        max-height: 100px;
      `;
        // Replace the input element with the textarea element in the DOM
        inputElement.parentNode.replaceChild(textAreaElement, inputElement);

        // animation
        let parentForMaxCharacter = document.querySelector(
          ".column-5.w-col.w-col-1"
        );
        let charSpan = document.createElement("span");
        charSpan.classList.add("max_char");
        charSpan.style.cssText =
          "color:red; font-size:12px;position: fixed;right: 55px;";
        parentForMaxCharacter.appendChild(charSpan);
        textAreaElement?.addEventListener("input", (e) => {
          var remaining = 356 - e.target.value.length;
          charSpan.textContent = remaining + "/356 left";
          const check = checkMessage(e.target.value);
        });

        // Event listener for Enter key press in the chat input field
        document
          .querySelector(".userinput.w-input")
          .addEventListener("keydown", function (event) {
            if (event.keyCode === 13 && !isSendMsg) {
              event.preventDefault();
              isSendMsg = true;
              document.activeElement.blur();
              const inputElement = document
                .querySelector(".sendbutton")
                ?.blur();
              scrollToLatestMessage();
              const userMessage = event.target.value.trim(); // Trim the input
              if (userMessage.length >= 2) {
                // Check if the message has at least 2 characters
                displayChatBubble("user", userMessage);
                postMessageToAPI(userMessage);
                clearUserInput();
              }
            } else return;
          });

        if (firstUserId) {
          // started
          const chatContainer = document.querySelector(".chat-container");
          const bubble = document.createElement("div");
          bubble.classList.add("chat-bubble1");
          bubble.classList.add("bot");
          bubble.classList.add("bubble");
          bubble.style.width = "100%";
          bubble.style.justifyContent = "center";
          bubble.style.alignItems = "center";
          bubble.style.display = "flex";
          const image = document.createElement("img");
          image.src =
            "https://uploads-ssl.webflow.com/651a1e741b97af0938ef7dd5/65caaf100d2e9c6e6c2df009_bubble.svg";
          image.style.marginBottom = "2px";
          image.style.width = "30px";
          image.style.bottom = "unset";
          image.style.left = "unset";
          chatContainer.style.marginBottom = "5px";
          bubble.textContent += "Loading";

          bubble.appendChild(image);
          chatContainer.appendChild(bubble);
          await conversationFromDb((data) => {
            if (data?.length === 0) {
              displayChatBubble(
                "bot",
                "Hey there! I'm all wagging tails and friendly barks, here to offer advice, answers, or just listen. What's your name?"
              );
            }
            bubble.remove();
            scrollToLatestMessage();
          });
        } else {
          displayChatBubble(
            "bot",
            "Hey there! I'm all wagging tails and friendly barks, here to offer advice, answers, or just listen. What's your name?"
          );
        }
      };
</script>
</body>
</html>